<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Debugging Issues &mdash; DISCO 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=2709fde1"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Ingestion" href="data-ingestion.html" />
    <link rel="prev" title="Pipelines" href="pipelines.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DISCO
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#conda-installation">Conda Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#developer-installation">Developer Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#data-sources">Data Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#transform-model">Transform Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#config-jobs">Config Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#submit-jobs">Submit Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#result-analysis">Result Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quick-start.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#source-data">Source Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#transform-model">Transform Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#config-jobs">Config Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#submit-jobs">Submit Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick-start.html#result-analysis">Result Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-sources.html">Data Sources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data-sources.html#generic-power-flow-models">Generic Power Flow Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-sources.html#sourcetree1-model">SourceTree1 Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-sources.html#sourcetree2-model">SourceTree2 Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-sources.html#gem-model">GEM Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-sources.html#epri-model">EPRI Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pv-deployments.html">PV Deployments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pv-deployments.html#sourcetree1-pv-deployments">SourceTree1 PV Deployments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transform-models.html">Transform Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transform-models.html#transform-model-help">Transform Model Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform-models.html#disco-model-in-depth">DISCO Model in Depth</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analysis-workflows.html">Analysis Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="analysis-workflows/hosting-capacity-analysis.html">Hosting Capacity Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-workflows/upgrade-cost-analysis.html">Upgrade Cost Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis-workflows/impact-analysis.html">Impact Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">Pipelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pipelines.html#sourcetree1model">SourceTree1Model</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Debugging Issues</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#disco-return-codes">DISCO Return Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-jade">Using JADE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-pydss">Using PyDSS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-ingestion.html">Data Ingestion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data-ingestion.html#ingest-to-new-database">Ingest to New Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-ingestion.html#ingest-to-existing-database">Ingest to Existing Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-ingestion.html#run-database-queries">Run Database Queries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced-guide.html">Advanced Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-guide/upgrade-cost-analysis-generic-models.html">Upgrade Cost Analysis JSON Schemas</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build-docs.html">Build docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DISCO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Debugging Issues</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/debugging-issues.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="debugging-issues">
<h1>Debugging Issues<a class="headerlink" href="#debugging-issues" title="Link to this heading">¶</a></h1>
<p>This page describes debugging techniques for issues encountered during the
simulation and analysis process. All of these tools produce output data in both
unstructured (.log) and structured form (.csv, .json, etc.).  Aggregating data
from a batch with thousands of jobs will often require use of UNIX tools (find,
grep, awk, etc.) along with bash or Python scripts to process data in stages.</p>
<section id="disco-return-codes">
<span id="id1"></span><h2>DISCO Return Codes<a class="headerlink" href="#disco-return-codes" title="Link to this heading">¶</a></h2>
<p>DISCO processes (snapshot, time-series, upgrades simulations) return these codes for known
conditions.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7.7%" />
<col style="width: 46.2%" />
<col style="width: 46.2%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>R	e	t	u	r	n	 	C	o	d	e</p></th>
<th class="head"><p>	D	e	s	c	r	i	p	t	i	o	n</p></th>
<th class="head"><p>	C	o	r	r	e	c	t	i	v	e	 	A	c	t	i	o	n</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Success</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Generic error</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>114</p></td>
<td><p>The input configuration is invalid.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>115</p></td>
<td><p>An Upgrades simulation exceeded the limit for parallel lines.</p></td>
<td><p>If not already done, enable ThermalUpgradeParamsModel.read_external_catalogand provide an external catalog. Or, increase ThermalUpgradeParamsModel.parallel_lines_limit to allow more parallel equipment tobe placed to resolve thermal violations.</p></td>
</tr>
<tr class="row-even"><td><p>116</p></td>
<td><p>An Upgrades simulation exceeded the limit for parallel transformers.</p></td>
<td><p>If not already done, enable ThermalUpgradeParamsModel.read_external_catalogand provide an external catalog. Or, increase ThermalUpgradeParamsModel.parallel_transformers_limit to allow more parallel equipment tobe placed to resolve thermal violations.</p></td>
</tr>
<tr class="row-odd"><td><p>117</p></td>
<td><p>An OpenDSS element has unexpected properties.</p></td>
<td><p>Check the error message and fix the OpenDSS element definitions.</p></td>
</tr>
<tr class="row-even"><td><p>118</p></td>
<td><p>OpenDSS failed to compile a model.</p></td>
<td><p>Check the error message and fix the OpenDSS model definitions.</p></td>
</tr>
<tr class="row-odd"><td><p>119</p></td>
<td><p>OpenDSS failed to converge.</p></td>
<td><p>Check the OpenDSS model. Also, refer to the OpenDSS manual to vary settings for convergence.</p></td>
</tr>
<tr class="row-even"><td><p>120</p></td>
<td><p>PyDSS failed to find a solution in its external controls.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>121</p></td>
<td><p>PyDSS external controls exceeded the threshold for error counts.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>122</p></td>
<td><p>PyDSS external controls exceeded the max tolerance error threshold.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>123</p></td>
<td><p>An Upgrades simulation requires an external catalog for thermal upgrades in order to add or upgrade a component.</p></td>
<td><p>Provide an external catalog or disable ThermalUpgradeParamsModel.read_external_catalog.</p></td>
</tr>
<tr class="row-even"><td><p>124</p></td>
<td><p>The Upgrades external catalog does not define a required object.</p></td>
<td><p>Ensure the external catalog defines all required objects. Refer to the error message for specific details.</p></td>
</tr>
<tr class="row-odd"><td><p>125</p></td>
<td><p>An Upgrades simulation detected an invalid increase in violations.</p></td>
<td><p>This could happen in cases when lines or transformers are extremely overloaded. Check and modify OpenDSS model for such instances.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="using-jade">
<h2>Using JADE<a class="headerlink" href="#using-jade" title="Link to this heading">¶</a></h2>
<p>Please refer to JADE documentation -
<a class="reference external" href="https://nrel.github.io/jade/tutorial.html#debugging">https://nrel.github.io/jade/tutorial.html#debugging</a></p>
<p>Note that if you need result status in structured form, such as if you want to
find all failed jobs, refer to <code class="docutils literal notranslate"><span class="pre">&lt;output-dir&gt;/results.json</span></code>.</p>
</section>
<section id="using-pydss">
<h2>Using PyDSS<a class="headerlink" href="#using-pydss" title="Link to this heading">¶</a></h2>
<p>DISCO creates a PyDSS project directory for each simulation job. The directory
will have the following contents:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">project.zip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">store.h5</span></code></p></li>
</ul>
<p>When running on an HPC the directory contents will always be zipped because
huge numbers of directories can be problematic for the shared filesystem.</p>
<p>Here is example content of an extracted job:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>find<span class="w"> </span>output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project

output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/DSSfiles
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/DSSfiles/deployment.dss
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Exports
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Exports/control_mode
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Logs
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Logs/pydss.log
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Logs/pydss_project__control_mode__reports.log
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Scenarios
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Scenarios/control_mode
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Scenarios/control_mode/ExportLists/Exports.toml
output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss-project/Scenarios/control_mode/pyControllerList/PvControllers.toml
</pre></div>
</div>
<p>To debug a problem you can unzip the contents. However, this can be problematic
if you need to inspect lots of jobs. You may be better off using a tool like
<code class="docutils literal notranslate"><span class="pre">Vim</span></code> that lets you view compressed files in place.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">zipgrep</span></code> to search specific files within the .zip for
patterns. This is extremely helpful if you need to inspect many jobs. This tool
uses <code class="docutils literal notranslate"><span class="pre">egrep</span></code> so you may need to consult help from both locations to customize
searches.</p>
<section id="errors">
<h3>Errors<a class="headerlink" href="#errors" title="Link to this heading">¶</a></h3>
<p>All errors get logged in <code class="docutils literal notranslate"><span class="pre">pydss.log</span></code>. Look there for problems reported by
OpenDSS.</p>
</section>
<section id="searching-for-errors">
<h3>Searching for errors<a class="headerlink" href="#searching-for-errors" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Here is an example of searching for a pattern without unzipping:</p>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>zipgrep<span class="w"> </span><span class="s2">&quot;Convergence error&quot;</span><span class="w"> </span>output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss_project/project.zip<span class="w"> </span>Logs/pydss.log
</pre></div>
</div>
<p>Here is an example that searches all jobs:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="k">for</span><span class="w"> </span>x<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>find<span class="w"> </span>output/job-outputs<span class="w"> </span>-name<span class="w"> </span>project.zip<span class="sb">`</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$x</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span>zipgrep<span class="w"> </span><span class="s2">&quot;Convergence error&quot;</span><span class="w"> </span><span class="nv">$x</span><span class="w"> </span>Logs/pydss.log<span class="p">;</span><span class="w"> </span><span class="k">done</span>
</pre></div>
</div>
<p>You will likely want to redirect that command’s output to another file for
further processing (or pipe it to another command).</p>
</section>
<section id="convergence-errors">
<h3>Convergence errors<a class="headerlink" href="#convergence-errors" title="Link to this heading">¶</a></h3>
<p>PyDSS creates a report showing each instance of a convergence error for a PV
controller.  An example name of this file is
<code class="docutils literal notranslate"><span class="pre">pydss_project__control_mode__reports.log</span></code>. This file contains line-delimited
JSON objects.  This means that each line is valid JSON but the entire file is
not.</p>
<p>Here is an example of one line of the file pretty-printed as JSON:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Report&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Convergence&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Scenario&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;control_mode&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Time&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">523800</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;DateTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-01-07 01:30:00&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pyCont_PVSystem_small_p1ulv32837_1_2_pv&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Controlled element&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PVSystem.small_p1ulv32837_1_2_pv&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Error&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00241144335086263</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Control algorithm&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VVar&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here are some example commands to convert the file to JSON. This example uses
an excellent 3rd-party JSON-parsing tool called <code class="docutils literal notranslate"><span class="pre">jq</span></code> which you have to
install. (On Eagle: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">jq</span></code>). You may have a
different method.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>zipgrep<span class="w"> </span>-h<span class="w"> </span>Convergence<span class="w"> </span>output/job-outputs/p1uhs9_1247__p1udt6854__random__9__100/pydss_project/project.zip<span class="w"> </span>Logs/pydss_project__control_mode__reports.log<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.<span class="w"> </span>-s
</pre></div>
</div>
<p><strong>Note</strong>: That command used <code class="docutils literal notranslate"><span class="pre">-h</span></code> to suppress the filename from the output.</p>
<p>This next command will do do the same for all jobs. Note that it loses the
association between job and error. You would need to do some extra work to keep
those associations.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="k">for</span><span class="w"> </span>x<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="sb">`</span>find<span class="w"> </span>output/job-outputs<span class="w"> </span>-name<span class="w"> </span>project.zip<span class="sb">`</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>zipgrep<span class="w"> </span>-h<span class="w"> </span><span class="s2">&quot;Convergence&quot;</span><span class="w"> </span><span class="nv">$x</span><span class="w"> </span>Logs/pydss_project__control_mode__reports.log<span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.<span class="w"> </span>-s
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware of how much CPU and memory will be consumed by these
operations. You may want to redirect this output to a temporary text file
first.</p>
</div>
<p>In both cases you will probably want to redirect the output to a JSON file for
further processing.</p>
</section>
<section id="running-searches-in-parallel">
<h3>Running searches in parallel<a class="headerlink" href="#running-searches-in-parallel" title="Link to this heading">¶</a></h3>
<p>The DISCO repository has a script that extracts data from <code class="docutils literal notranslate"><span class="pre">project.zip</span></code> with
the Python multiprocessing library. You can use this as an example to speed up
large searches. Do not run this kind of search on an HPC login node.</p>
<p>Refer to <code class="docutils literal notranslate"><span class="pre">disco/cli/make_summary_tables.py</span></code>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pipelines.html" class="btn btn-neutral float-left" title="Pipelines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data-ingestion.html" class="btn btn-neutral float-right" title="Data Ingestion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, NREL.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>